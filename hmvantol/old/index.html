<!DOCTYPE html>
<meta charset="utf-8">
<html>
<style>

body {
	font-family: sans-serif;
	font-size: 12px;
}

.axis path,
.axis line {
	fill: none;
	stroke: black;
	shape-rendering: crispEdges;
}

.line {
	fill: none;
	stroke: white;
	stroke-width: 3px;
}

.svg-container {
    display: inline-block;
    position: relative;
    width: 100%;
    padding-bottom: 100%; /* aspect ratio */
    vertical-align: top;
  
    overflow: hidden;
}

.svg-content-responsive {
    display: inline-block;
    position: absolute;
    top: 10px;
    left: 0;
}

</style>

<body>
<script src="//d3js.org/d3.v3.min.js" charset="utf=8"></script>
<script>

var w = 720*2,
	h = 480;

var width = .7*w,
	height = .7*h;

var svg = d3.select("body")
		.append("svg")
		.attr("id", "satellite")
		.attr("width", width)
		.attr("height", height)
		.classed("svg-container",true)
		.classed("svg-content-responsive", true)
		.attr("viewBox", "0 0 " + width + " " + height);

var image = svg.append("image")
	.attr("xlink:href","flooding.png")
	.attr("width", width)
	.attr("height", height)
	.attr("id","flooding")
	.style("opacity",1);

svg.append("text")
	.text("November 7, 1984")
	.attr("x",10)
	.attr("y",25)
	.style("font-size", "24px")
	.style("fill","white");

svg.append("text")
	.text("October 12, 2015")
	.attr("x",.5*width+10)
	.attr("y",25)
	.style("font-size", "24px")
	.style("fill","white");


var margin = {top:40, right:20, bottom:10, left:50};

var x = d3.time.scale()
	.range([0,width - margin.left - margin.right]);

var y = d3.scale.linear()
	.range([height - margin.top - margin.bottom, margin.top]);

var x_axis = d3.svg.axis()
	.scale(x)
	.orient("bottom");

var y_axis = d3.svg.axis()
	.scale(y)
	.orient("left");

var line = d3.svg.line()
	.x(function(d) { return x(d.year); })
	.y(function(d) { return y(d.fake_data); });

d3.csv("flooding.csv", function(data) {
	
	var parseDate = d3.time.format("%Y").parse;

	data.forEach(function(d) {
		d.year = parseDate(d.year);
		d.fake_data = +d.fake_data;
	});

	x.domain(d3.extent(data, function(d) { return d.year; }));
	y.domain(d3.extent(data, function(d) { return d.fake_data; }));

	svg.append("path")
		.datum(data)
		.attr("class", "line")
		.attr("transform", "translate(" + margin.left + ",0)")
		.attr("d",line)
		.style("opacity",0);

	svg.selectAll("circle")
		.data(data).enter()
		.append("circle")
		.filter(function(d) { return (d.year.getTime() == parseDate("1984").getTime() || d.year.getTime() == parseDate("2015").getTime()) ; })
		.attr("cx", function(d) { return x(d.year); })
		.attr("cy", function(d) { return y(d.fake_data); })
		.attr("transform", "translate("+margin.left+",0)")
		.attr("r", "6px")
		.style("opacity",0);

	svg.selectAll("text")
		.data(data).enter()
		.append("text")
		.filter(function(d) { return (d.year.getTime() == parseDate("1984").getTime() || d.year.getTime() == parseDate("2015").getTime()) ; })
		.attr("id", "label")
		.text(function(d) { return d.year.getFullYear(); })
		.attr("x", function(d) { return x(d.year)+5; })
		.attr("y", function(d) { return y(d.fake_data)-5; })
		.attr("transform", "translate("+margin.left+",0)")
		.style("font-size", "14px")
		.style("opacity",0);

	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(" + margin.left + "," + [height - margin.top - margin.bottom] + ")")
		.call(x_axis)
		.style("opacity",0);

	svg.append("g")
		.attr("class", "y axis")
		.attr("transform", "translate(" + margin.left + ",0)")
		.call(y_axis)
		.style("opacity",0);

	svg.append("text")
		.attr("class", "x label")
		.attr("id", "label")
		.attr("text-anchor", "middle")
		.attr("x", width/2)
		.attr("y", height - margin.bottom)
		.attr("font-size", "14px")
		.text("Year")
		.style("font-weight", "bold")
		.style("opacity",0);

	svg.append("text")
		.attr("class", "y label")
		.attr("id", "label")
		.attr("text-anchor", "middle")
		.attr("transform", "translate("+margin.left/3+","+(height-margin.top-margin.bottom)/2+")rotate(-90)")
		.attr("font-size", "14px")
		.text("Flooding (m)")
		.style("font-weight", "bold")
		.style("opacity",0);

	var click = 0;

	svg.on({
		"mouseover":function(d) {
			d3.select("image").style("opacity",0.5);
			d3.selectAll("g").style("opacity",1);
			d3.select("path").style("opacity",1);
			d3.selectAll("#label").style("opacity",1)
			d3.selectAll("circle").style("opacity",1);
		},
		"mouseout": function(d) {
			d3.select("image").style("opacity",1);
			d3.selectAll("g").style("opacity",0);
			d3.select("path").style("opacity",0);
			d3.selectAll("#label").style("opacity",0)
			d3.selectAll("circle").style("opacity",0);
		},
		"click": function(d) {
			if (click == 0) {
				d3.select("image").style("opacity",0.5);
				d3.selectAll("g").style("opacity",1);
				d3.select("path").style("opacity",1);
				d3.selectAll("#label").style("opacity",1)
				d3.selectAll("circle").style("opacity",1);
				click++;
			}
			else {
				d3.select("image").style("opacity",1);
				d3.selectAll("g").style("opacity",0);
				d3.select("path").style("opacity",0);
				d3.selectAll("#label").style("opacity",0)
				d3.selectAll("circle").style("opacity",0);
				click = 0;
			}
		}
	});

});

</script>
</body>
</html>